<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>cookie - GNU Wget 使用筆記</title>
      
      
      
        <link rel="canonical" href="https://foreachsam.github.io/book-util-wget/book/content/usage/cookie/">
      
      
        <meta name="author" content="foreachsam">
      
    
    <meta property="og:url" content="https://foreachsam.github.io/book-util-wget/book/content/usage/cookie/">
    <meta property="og:title" content="GNU Wget 使用筆記">
    <meta property="og:image" content="https://foreachsam.github.io/book-util-wget/book/content/usage/cookie//../../../">
    <meta name="apple-mobile-web-app-title" content="GNU Wget 使用筆記">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../../None">
    <link rel="icon" type="image/x-icon" href="../../../None">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../../assets/fonts/icon.eot?52m981');
      	src: url('../../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../../assets/stylesheets/application-54f87043f3.css">
    
      <link rel="stylesheet" href="../../../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto+Mono">
      <style>
        body, input {
          font-family: 'Roboto', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
    <script src="../../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-brown palette-accent-light-brown">
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                usage <i class="icon icon-link"></i>
              
            
          </span>
        
        cookie
      </div>
    </div>
    
    
      
      <div class="button button-github" role="button" aria-label="GitHub">
        <a href="https://github.com/foreachsam/book-util-wget" title="@foreachsam/book-util-wget on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
      </div>
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="/" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          GNU Wget 使用筆記
          <span class="version">
            
          </span>
        </strong>
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="首頁" href="../../..">
      首頁
    </a>
    
  </li>

          
            
  <li>
    <span class="section">參考文件</span>
    <ul>
      
        
  <li>
    <a class="" title="manual" href="../../reference/manual/">
      manual
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">deb package</span>
    <ul>
      
        
  <li>
    <a class="" title="index" href="../../deb-package/">
      index
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="wget" href="../../deb-package/wget/">
      wget
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">command</span>
    <ul>
      
        
  <li>
    <a class="" title="wget" href="../../command/wget/">
      wget
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">usage</span>
    <ul>
      
        
  <li>
    <a class="" title="basic" href="../basic/">
      basic
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="cookie" href="./">
      cookie
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="manpage" href="#manpage">
                manpage
              </a>
            </li>
          
            <li class="anchor">
              <a title="範例" href="#_2">
                範例
              </a>
            </li>
          
            <li class="anchor">
              <a title="啟動「測試 Web Server」" href="#web-server">
                啟動「測試 Web Server」
              </a>
            </li>
          
            <li class="anchor">
              <a title="切換到測試路徑" href="#_4">
                切換到測試路徑
              </a>
            </li>
          
            <li class="anchor">
              <a title="測試" href="#_5">
                測試
              </a>
            </li>
          
            <li class="anchor">
              <a title="更多參考" href="#_6">
                更多參考
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
          <hr>
          <span class="section">The author</span>
          <ul>
            
            
              
              <li>
                <a href="https://github.com/foreachsam/book-util-wget" target="_blank" title="@foreachsam/book-util-wget on GitHub">
                  @foreachsam/book-util-wget on GitHub
                </a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="cookie">cookie</h1>
<h2 id="manpage">manpage</h2>
<p>$ man <a href="http://manpages.ubuntu.com/manpages/xenial/en/man1/wget.1.html">wget</a></p>
<p>可以找到跟「cookie」相關的使用說明</p>
<h3 id="-no-cookies">--no-cookies</h3>
<pre class="code"><code>--no-cookies
    Disable the use of cookies.  Cookies are a mechanism for maintaining server-side state.  The server sends
    the client a cookie using the &quot;Set-Cookie&quot; header, and the client responds with the same cookie upon
    further requests.  Since cookies allow the server owners to keep track of visitors and for sites to
    exchange this information, some consider them a breach of privacy.  The default is to use cookies; however,
    storing cookies is not on by default.</code></pre>


<h3 id="-load-cookies-file">--load-cookies file</h3>
<pre class="code"><code>--load-cookies file
    Load cookies from file before the first HTTP retrieval.  file is a textual file in the format originally
    used by Netscape's cookies.txt file.

    You will typically use this option when mirroring sites that require that you be logged in to access some
    or all of their content.  The login process typically works by the web server issuing an HTTP cookie upon
    receiving and verifying your credentials.  The cookie is then resent by the browser when accessing that
    part of the site, and so proves your identity.

    Mirroring such a site requires Wget to send the same cookies your browser sends when communicating with the
    site.  This is achieved by --load-cookies---simply point Wget to the location of the cookies.txt file, and
    it will send the same cookies your browser would send in the same situation.  Different browsers keep
    textual cookie files in different locations:

    &quot;Netscape 4.x.&quot;
        The cookies are in ~/.netscape/cookies.txt.

    &quot;Mozilla and Netscape 6.x.&quot;
        Mozilla's cookie file is also named cookies.txt, located somewhere under ~/.mozilla, in the directory
        of your profile.  The full path usually ends up looking somewhat like ~/.mozilla/default/some-weird-
        string/cookies.txt.

    &quot;Internet Explorer.&quot;
        You can produce a cookie file Wget can use by using the File menu, Import and Export, Export Cookies.
        This has been tested with Internet Explorer 5; it is not guaranteed to work with earlier versions.

    &quot;Other browsers.&quot;
        If you are using a different browser to create your cookies, --load-cookies will only work if you can
        locate or produce a cookie file in the Netscape format that Wget expects.

    If you cannot use --load-cookies, there might still be an alternative.  If your browser supports a &quot;cookie
    manager&quot;, you can use it to view the cookies used when accessing the site you're mirroring.  Write down the
    name and value of the cookie, and manually instruct Wget to send those cookies, bypassing the &quot;official&quot;
    cookie support:

            wget --no-cookies --header &quot;Cookie: &lt;name&gt;=&lt;value&gt;&quot;</code></pre>


<h3 id="-save-cookies-file">--save-cookies file</h3>
<pre class="code"><code>--save-cookies file
    Save cookies to file before exiting.  This will not save cookies that have expired or that have no expiry
    time (so-called &quot;session cookies&quot;), but also see --keep-session-cookies.</code></pre>


<h3 id="-keep-session-cookies">--keep-session-cookies</h3>
<pre class="code"><code>--keep-session-cookies
    When specified, causes --save-cookies to also save session cookies.  Session cookies are normally not saved
    because they are meant to be kept in memory and forgotten when you exit the browser.  Saving them is useful
    on sites that require you to log in or to visit the home page before you can access some pages.  With this
    option, multiple Wget runs are considered a single browser session as far as the site is concerned.

    Since the cookie file format does not normally carry session cookies, Wget marks them with an expiry
    timestamp of 0.  Wget's --load-cookies recognizes those as session cookies, but it might confuse other
    browsers.  Also note that cookies so loaded will be treated as other session cookies, which means that if
    you want --save-cookies to preserve them again, you must use --keep-session-cookies again.</code></pre>


<h3 id="_1">相關案例說明</h3>
<pre class="code"><code>--post-data=string
--post-file=file
    Use POST as the method for all HTTP requests and send the specified data in the request body.  --post-data
    sends string as data, whereas --post-file sends the contents of file.  Other than that, they work in
    exactly the same way. In particular, they both expect content of the form &quot;key1=value1&amp;key2=value2&quot;, with
    percent-encoding for special characters; the only difference is that one expects its content as a command-
    line parameter and the other accepts its content from a file. In particular, --post-file is not for
    transmitting files as form attachments: those must appear as &quot;key=value&quot; data (with appropriate percent-
    coding) just like everything else. Wget does not currently support &quot;multipart/form-data&quot; for transmitting
    POST data; only &quot;application/x-www-form-urlencoded&quot;. Only one of --post-data and --post-file should be
    specified.

    Please note that wget does not require the content to be of the form &quot;key1=value1&amp;key2=value2&quot;, and neither
    does it test for it. Wget will simply transmit whatever data is provided to it. Most servers however expect
    the POST data to be in the above format when processing HTML Forms.

    When sending a POST request using the --post-file option, Wget treats the file as a binary file and will
    send every character in the POST request without stripping trailing newline or formfeed characters. Any
    other control characters in the text will also be sent as-is in the POST request.

    Please be aware that Wget needs to know the size of the POST data in advance.  Therefore the argument to
    &quot;--post-file&quot; must be a regular file; specifying a FIFO or something like /dev/stdin won't work.  It's not
    quite clear how to work around this limitation inherent in HTTP/1.0.  Although HTTP/1.1 introduces chunked
    transfer that doesn't require knowing the request length in advance, a client can't use chunked unless it
    knows it's talking to an HTTP/1.1 server.  And it can't know that until it receives a response, which in
    turn requires the request to have been completed -- a chicken-and-egg problem.

    Note: As of version 1.15 if Wget is redirected after the POST request is completed, its behaviour will
    depend on the response code returned by the server.  In case of a 301 Moved Permanently, 302 Moved
    Temporarily or 307 Temporary Redirect, Wget will, in accordance with RFC2616, continue to send a POST
    request.  In case a server wants the client to change the Request method upon redirection, it should send a
    303 See Other response code.

    This example shows how to log in to a server using POST and then proceed to download the desired pages,
    presumably only accessible to authorized users:

            # Log in to the server.  This can be done only once.
            wget --save-cookies cookies.txt \
                 --post-data 'user=foo&amp;password=bar' \
                 http://server.com/auth.php

            # Now grab the page or pages we care about.
            wget --load-cookies cookies.txt \
                 -p http://server.com/interesting/article.php

    If the server is using session cookies to track user authentication, the above will not work because
    --save-cookies will not save them (and neither will browsers) and the cookies.txt file will be empty.  In
    that case use --keep-session-cookies along with --save-cookies to force saving of session cookies.</code></pre>


<h2 id="_2">範例</h2>
<h3 id="_3">前置作業</h3>
<p>執行下面的指令，產生一個檔案「index.php」。</p>
<pre class="code"><code class="language-sh">cat &gt; index.php &lt;&lt;EOL
&lt;?php

    var_dump(\$_COOKIE);
EOL</code></pre>


<p>內容如下</p>
<pre class="code"><code class="language-php">&lt;?php

    var_dump($_COOKIE);</code></pre>


<p>執行下面的指令，產生一個檔案「cookie.php」。</p>
<pre class="code"><code class="language-sh">cat &gt; cookie.php &lt;&lt;EOL
&lt;?php

\$value = 'something from somewhere';

setcookie(&quot;TestCookie&quot;, \$value);
EOL</code></pre>


<p>內容如下</p>
<pre class="code"><code class="language-php">&lt;?php

$value = 'something from somewhere';

setcookie(&quot;TestCookie&quot;, $value);</code></pre>


<p>執行下面的指令，產生一個檔案「session.php」。</p>
<pre class="code"><code class="language-sh">cat &gt; session.php &lt;&lt;EOL
&lt;?php

    session_start();
EOL</code></pre>


<p>內容如下</p>
<pre class="code"><code class="language-php">&lt;?php

    session_start();</code></pre>


<h2 id="web-server">啟動「測試 Web Server」</h2>
<p>執行</p>
<pre class="code"><code>$ php -S localhost:8080</code></pre>


<h2 id="_4">切換到測試路徑</h2>
<p>另外開一個「Terminal」</p>
<p>執行</p>
<pre class="code"><code class="language-sh">mkdir test -p
cd test</code></pre>


<h2 id="_5">測試</h2>
<p>執行</p>
<pre class="code"><code>$ wget localhost:8080</code></pre>


<p>會產生一個檔案「index.html」</p>
<p>執行</p>
<pre class="code"><code>$ cat index.html</code></pre>


<p>顯示</p>
<pre class="code"><code>array(0) {                                                                                                                
}    </code></pre>


<p>執行</p>
<pre class="code"><code class="language-sh">$ wget localhost:8080/cookie.php --keep-session-cookies --save-cookies cookie.txt</code></pre>


<p>會產生檔案「cookie.php」和「cookie.txt」</p>
<p>執行</p>
<pre class="code"><code class="language-sh">$ cat cookie.php</code></pre>


<p>沒有任何顯示，執行出現下一個提示字元。</p>
<p>執行</p>
<pre class="code"><code>$ cat cookie.txt</code></pre>


<p>顯示</p>
<pre class="code"><code># HTTP cookie file.
# Generated by Wget on 2016-05-12 21:35:21.
# Edit at your own risk.

localhost:8080  FALSE   /       FALSE   0       TestCookie      something+from+somewhere</code></pre>


<p>刪除「index.html」</p>
<pre class="code"><code>$ rm index.html</code></pre>


<p>執行</p>
<pre class="code"><code class="language-sh">$ wget localhost:8080 --load-cookies cookie.txt</code></pre>


<p>會產生一個檔案「index.html」。</p>
<p>執行下面指令，觀看「index.html」。</p>
<pre class="code"><code class="language-sh">$ cat index.html</code></pre>


<p>顯示</p>
<pre class="code"><code>array(1) {
  [&quot;TestCookie&quot;]=&gt;
  string(24) &quot;something from somewhere&quot;
}</code></pre>


<p>執行</p>
<pre class="code"><code class="language-sh">$ wget localhost:8080/session.php --keep-session-cookies --save-cookies cookie.txt</code></pre>


<p>會產生檔案「session.php」和「cookie.txt」</p>
<p>執行</p>
<pre class="code"><code class="language-sh">$ cat session.php</code></pre>


<p>沒有任何顯示，執行出現下一個提示字元。</p>
<p>執行</p>
<pre class="code"><code>$ cat cookie.txt</code></pre>


<p>顯示</p>
<pre class="code"><code># HTTP cookie file.
# Generated by Wget on 2016-05-12 21:51:42.
# Edit at your own risk.

localhost:8080  FALSE   /       FALSE   0       PHPSESSID       6u9k9bgolqvcttfun9fftrue85</code></pre>


<h2 id="_6">更多參考</h2>
<ul>
<li>維基百科 / https://zh.wikipedia.org/zh-tw/Cookie)</li>
<li>Wikipedia / <a href="https://en.wikipedia.org/wiki/HTTP_cookie">HTTP_cookie</a></li>
<li>PHP / <a href="http://php.net/manual/en/function.setcookie.php">setcookie</a></li>
<li>PHP / <a href="http://php.net/manual/en/reserved.variables.cookies.php">$_COOKIE</a></li>
<li>PHP / <a href="http://php.net/manual/en/features.commandline.webserver.php">Built-in web server</a></li>
</ul>
          <aside class="copyright" role="note">
            
              Copyright (c) foreachsam &ndash;
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../basic/" title="basic">
          <span class="direction">
            上一頁
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                basic
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../../..';
      var repo_id  = '';
    </script>
    <script src="../../../assets/javascripts/application-997097ee0c.js"></script>
    
    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
        /* General initialization */
        ga('create', 'UA-56999876-1', 'foreachsam.github.io');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
        /* Track outbound links */
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
        /* Register handler to log search on blur */
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    
  </body>
</html>